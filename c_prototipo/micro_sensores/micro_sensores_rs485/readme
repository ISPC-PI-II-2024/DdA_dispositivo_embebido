# ğŸŒ¡ï¸ Micro-sensores RS485 - Sistema de Monitoreo

<div align="center">

![ESP8266](https://img.shields.io/badge/ESP8266-NodeMCU-red?style=for-the-badge)
![RS485](https://img.shields.io/badge/Protocolo-RS485-blue?style=for-the-badge)
![PlatformIO](https://img.shields.io/badge/PlatformIO-IDE-orange?style=for-the-badge)

**Sistema distribuido de monitoreo ambiental para silos agrÃ­colas**

</div>

## ğŸ“‹ Tabla de Contenidos
- [DescripciÃ³n](#-descripciÃ³n)
- [Arquitectura](#ğŸ—ï¸-arquitectura)
- [InstalaciÃ³n](#ğŸš€-instalaciÃ³n)
- [ConfiguraciÃ³n](#âš™ï¸-configuraciÃ³n)
- [Protocolo](#ğŸ“¡-protocolo-de-comunicaciÃ³n)
- [Uso](#ğŸ¯-uso)
- [Troubleshooting](#ğŸ›-soluciÃ³n-de-problemas)

## ğŸ¯ DescripciÃ³n

Sistema de monitoreo en tiempo real que utiliza **ESP8266 como nodos sensores** distribuidos, comunicÃ¡ndose via **RS485** con un concentrador central. DiseÃ±ado especÃ­ficamente para entornos agrÃ­colas con mÃºltiples silos.

### CaracterÃ­sticas Principales
- âœ… Monitoreo simultÃ¡neo de **temperatura y humedad**
- âœ… ComunicaciÃ³n **RS485 de largo alcance** (hasta 1200m)
- âœ… Protocolo **robusto con checksum CRC**
- âœ… **Auto-descubrimiento** de dispositivos
- âœ… ConfiguraciÃ³n individual por **direcciÃ³n Ãºnica**

## ğŸ—ï¸ Arquitectura

```mermaid
graph TB
    A[Sensor AHT10] --> B[ESP8266]
    B --> C[RS485 Bus]
    C --> D[ESP32-C3 Endpoint]
    D --> E[LoRa Gateway]
    E --> F[Backend Cloud]
    
    subgraph "Nodos Sensores"
    B
    end
    
    style B fill:#e1f5fe
    style D fill:#f3e5f5
    style E fill:#e8f5e8

    ğŸš€ InstalaciÃ³n RÃ¡pida
Prerrequisitos
PlatformIO IDE (extensiÃ³n VS Code)

ESP8266 NodeMCU o compatible

Sensor AHT10

MÃ³dulo MAX485

1. Clonar Repositorio
bash
git clone https://github.com/tuusuario/micro-sensores-rs485.git
cd micro-sensores-rs485
2. Configurar PlatformIO
El archivo platformio.ini ya estÃ¡ configurado:

ini
[env:nodemcuv2]
platform = espressif8266
board = nodemcuv2
framework = arduino
monitor_speed = 115200

lib_deps = adafruit/Adafruit AHTX0
3. Configurar Dispositivo
Editar src/main.cpp:

cpp
// ğŸ”§ CONFIGURACIÃ“N INDIVIDUAL POR DISPOSITIVO
#define MY_ADDRESS 0x01              // DirecciÃ³n Ãºnica 1-32
#define DEVICE_TYPE "AHT10_SENSOR"   
#define DEVICE_LOCATION "Silo_Norte" // UbicaciÃ³n fÃ­sica
4. Compilar y Subir
bash
pio run -t upload
ğŸ”Œ Diagrama de Conexiones
Conexiones AHT10
Sensor	ESP8266	Color Recomendado
VCC	3.3V	Rojo
GND	GND	Negro
SDA	GPIO4	Azul
SCL	GPIO5	Verde
Conexiones MAX485 (RS485)
MÃ³dulo	ESP8266	FunciÃ³n
RO	GPIO13	RecepciÃ³n
DI	GPIO12	TransmisiÃ³n
DE/RE	GPIO14	Control
VCC	3.3V	AlimentaciÃ³n
GND	GND	Tierra
ğŸ“¡ Protocolo de ComunicaciÃ³n
Estructura de Mensajes
text
ADDR:[DIRECCIÃ“N]|CMD:[COMANDO]|[PARÃMETROS]|CRC:[CHECKSUM]
Comandos Implementados
ğŸ” DISCOVERY - IdentificaciÃ³n
Request:

plaintext
ADDR:BROADCAST|CMD:DISCOVERY|CRC:XXXX
Response:

plaintext
ADDR:01|CMD:DISCOVERY_RESP|TYPE:AHT10_SENSOR|LOC:Silo_Norte|STATUS:READY|TEMP:25.5|HUM:60.2|CRC:ABCD
ğŸŒ¡ï¸ READ_SENSOR - Lectura
Request:

plaintext
ADDR:01|CMD:READ_SENSOR|CRC:XXXX
Response:

plaintext
ADDR:01|CMD:SENSOR_DATA|TEMP:25.5|HUM:60.2|UNIT_TEMP:C|UNIT_HUM:%|TIMESTAMP:123456789|CRC:ABCD
ğŸ¯ Uso del Sistema
Monitoreo en Tiempo Real
bash
pio device monitor
Salida Esperada:

plaintext
ğŸš€ MICRO-SENSOR RS485 - INICIANDO
ğŸ“ DirecciÃ³n: 1 | ğŸ“ UbicaciÃ³n: Silo_Norte
âœ… SENSOR AHT10 INICIALIZADO
ğŸ“¤ RS485 >>> ADDR:01|CMD:HEARTBEAT|STATUS:READY|UPTIME:30s
ğŸ“Š Sensor - Temp: 25.5Â°C, Hum: 60.2%
Comandos de Prueba
Para probar manualmente, enviar por monitor serial:

plaintext
TEST:DISCOVERY
TEST:READ_SENSOR
âš™ï¸ ConfiguraciÃ³n Avanzada
Intervalos de Tiempo
cpp
#define HEARTBEAT_INTERVAL 30000    // 30 segundos
#define SENSOR_READ_INTERVAL 5000   // 5 segundos (debug)
Estados del Sistema
BOOTING: InicializaciÃ³n

READY: Operativo

SENSOR_ERROR: Fallo de sensor

COMM_ERROR: Error comunicaciÃ³n

ğŸ› SoluciÃ³n de Problemas
Error ComÃºn: Sensor No Detectado
SÃ­ntoma: Mensaje "âŒ FALLO" en inicializaciÃ³n

SoluciÃ³n:

Verificar conexiones I2C (SDA/SCL)

Confirmar alimentaciÃ³n 3.3V estable

Usar scanner I2C para detectar direcciones

Error ComÃºn: Sin ComunicaciÃ³n RS485
SoluciÃ³n:

Revisar pines RO/DI/DE-RE

Confirmar velocidad 9600 bauds

Verificar terminaciÃ³n de bus

Logs de DepuraciÃ³n
Habilitar logs detallados modificando:

cpp
Serial.println("ğŸ” [DEBUG] " + mensaje);
ğŸ“Š Estructura del Proyecto
text
micro_sensores_rs485/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main.cpp              # CÃ³digo principal
â”œâ”€â”€ lib/                      # LibrerÃ­as adicionales
â”œâ”€â”€ test/                     # Pruebas unitarias
â”œâ”€â”€ platformio.ini           # ConfiguraciÃ³n PlatformIO
â””â”€â”€ README.md               # Este archivo
ğŸ”„ Flujo de Datos
InicializaciÃ³n â†’ Verifica hardware y configura RS485

Escucha â†’ Espera comandos del maestro RS485

Procesamiento â†’ Ejecuta comandos y genera respuestas

TransmisiÃ³n â†’ EnvÃ­a datos con control DE/RE

Monitoreo â†’ Heartbeats automÃ¡ticos y lecturas locales

ğŸ‘¥ Desarrollo
PrÃ³ximas Mejoras
ConfiguraciÃ³n remota de parÃ¡metros

MÃ©tricas de calidad de seÃ±al

Modo bajo consumo

ActualizaciÃ³n OTA

Contribuir
Fork el proyecto

Crear feature branch (git checkout -b feature/nuevaFuncionalidad)

Commit cambios (git commit -am 'Add nueva funcionalidad')

Push branch (git push origin feature/nuevaFuncionalidad)

Abrir Pull Request

ğŸ“ Licencia
Distribuido bajo licencia MIT. Ver LICENSE para mÃ¡s informaciÃ³n.

ğŸ“ Soporte
Issues: GitHub Issues

Email: equipo.telecomunicaciones@instituto.edu


